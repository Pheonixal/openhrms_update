import datetime
from odoo.exceptions import UserError
from odoo import fields, models, api, _


class Appointment(models.Model):
    _inherit = 'lab.appointment'

    type_of_appointment = fields.Selection(
        [('daily', 'Daily'),
         ('monthly', 'Monthly'),
         ('quarter', 'Quarter')
         ]
    )
    permission = fields.Selection([
        ('granted', 'Granted'),
        ('denied', 'Denied'),
    ], string="Permission", index=True)

    duration = fields.Float(string="Duration")

    content = fields.Html('Content', readonly=True, default="""<p id="z1" style="margin-bottom: 1.5em; padding: 0px; border: 0px; outline: 0px; font-variant-numeric: normal; font-variant-east-asian: normal; font-stretch: normal; line-height: 19px; font-family: monospace; vertical-align: baseline; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial; letter-spacing: 0.1px; color: rgb(0, 0, 0); overflow: visible; text-shadow: none;">Об утверждении Правил проведения обязательных медицинских осмотров
            Приказ и.о. Министра национальной экономики Республики Казахстан от 24 февраля
            2015 года № 128. Зарегистрирован в Министерстве юстиции Республики Казахстан 8
            апреля 2015 года № 10634.<br></p><p id="z1" style="margin-bottom: 1.5em; padding: 0px; border: 0px; outline: 0px; font-variant-numeric: normal; font-variant-east-asian: normal; font-stretch: normal; line-height: 19px; font-family: monospace; vertical-align: baseline; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial; letter-spacing: 0.1px; color: rgb(0, 0, 0); overflow: visible; text-shadow: none;">В соответствии с <a href="http://adilet.zan.kz/rus/docs/K090000193_#z1566" style="margin: 0px; padding: 0px; vertical-align: baseline; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial; color: rgb(7, 58, 94); -webkit-tap-highlight-color: rgb(64, 170, 245);">пунктом 4</a> статьи 155 Кодекса Республики Казахстан от 18 сентября 2009 года "О здоровье народа и системе здравоохранения" <b style="margin: 0px; padding: 0px; border: 0px; outline: 0px; vertical-align: baseline; background: transparent;">ПРИКАЗЫВАЮ:</b></p><p id="z2" style="margin-bottom: 1.5em; padding: 0px; border: 0px; outline: 0px; font-variant-numeric: normal; font-variant-east-asian: normal; font-stretch: normal; line-height: 19px; font-family: monospace; vertical-align: baseline; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial; letter-spacing: 0.1px; color: rgb(0, 0, 0); overflow: visible; text-shadow: none;">      1. Утвердить прилагаемые <a href="http://adilet.zan.kz/rus/docs/V1500010634#z7" style="margin: 0px; padding: 0px; vertical-align: baseline; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial; color: rgb(7, 58, 94); -webkit-tap-highlight-color: rgb(64, 170, 245);">Правила</a> проведения обязательных медицинских осмотров.</p><p id="z3" style="margin-bottom: 1.5em; padding: 0px; border: 0px; outline: 0px; font-variant-numeric: normal; font-variant-east-asian: normal; font-stretch: normal; line-height: 19px; font-family: monospace; vertical-align: baseline; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial; letter-spacing: 0.1px; color: rgb(0, 0, 0); overflow: visible; text-shadow: none;">      2. Комитету по защите прав потребителей Министерства национальной экономики Республики Казахстан обеспечить в установленном законодательством порядке:</p><p style="margin-bottom: 1.5em; padding: 0px; border: 0px; outline: 0px; font-variant-numeric: normal; font-variant-east-asian: normal; font-stretch: normal; line-height: 19px; font-family: monospace; vertical-align: baseline; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial; letter-spacing: 0.1px; color: rgb(0, 0, 0); overflow: visible; text-shadow: none;">      1) государственную регистрацию настоящего приказа в Министерстве юстиции Республики Казахстан;</p><p style="margin-bottom: 1.5em; padding: 0px; border: 0px; outline: 0px; font-variant-numeric: normal; font-variant-east-asian: normal; font-stretch: normal; line-height: 19px; font-family: monospace; vertical-align: baseline; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial; letter-spacing: 0.1px; color: rgb(0, 0, 0); overflow: visible; text-shadow: none;">      2) в течение десяти календарных дней после государственной регистрации настоящего приказа его направление на официальное опубликование в периодических печатных изданиях и в информационно-правовой системе "Әділет";</p><p style="margin-bottom: 1.5em; padding: 0px; border: 0px; outline: 0px; font-variant-numeric: normal; font-variant-east-asian: normal; font-stretch: normal; line-height: 19px; font-family: monospace; vertical-align: baseline; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial; letter-spacing: 0.1px; color: rgb(0, 0, 0); overflow: visible; text-shadow: none;">      3) размещение настоящего приказа на официальном интернет-ресурсе Министерства национальной экономики Республики Казахстан.</p><p id="z4" style="margin-bottom: 1.5em; padding: 0px; border: 0px; outline: 0px; font-variant-numeric: normal; font-variant-east-asian: normal; font-stretch: normal; line-height: 19px; font-family: monospace; vertical-align: baseline; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial; letter-spacing: 0.1px; color: rgb(0, 0, 0); overflow: visible; text-shadow: none;">      3. Контроль за исполнением настоящего приказа возложить на курирующего вице-министра национальной экономики Республики Казахстан.</p><p id="z5" style="margin-bottom: 1.5em; padding: 0px; border: 0px; outline: 0px; font-variant-numeric: normal; font-variant-east-asian: normal; font-stretch: normal; line-height: 19px; font-family: monospace; vertical-align: baseline; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial; letter-spacing: 0.1px; color: rgb(0, 0, 0); overflow: visible; text-shadow: none;">      4. Настоящий приказ вводится в действие по истечении десяти календарных дней со дня его первого официального опубликования.</p><p style="margin-bottom: 1.5em; padding: 0px; border: 0px; outline: 0px; font-variant-numeric: normal; font-variant-east-asian: normal; font-stretch: normal; line-height: 19px; font-family: monospace; vertical-align: baseline; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial; letter-spacing: 0.1px; color: rgb(0, 0, 0); overflow: visible; text-shadow: none;"></p><table border="0" width="615" style="margin: 0px auto; padding: 0px; border: 0px; outline: 0px; vertical-align: baseline; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial; border-spacing: 0px; overflow-wrap: break-word; table-layout: fixed; width: 892px; color: rgb(0, 0, 0); font-family: monospace;"><tbody style="margin: 0px; padding: 0px; border: 0px; outline: 0px; vertical-align: baseline; background: transparent;"><tr style="margin: 0px; padding: 0px; border: 0px; outline: 0px; vertical-align: baseline; background: transparent;"><td style="margin: 0px; padding: 3px 5px; border: 0px; outline: 0px; vertical-align: top; background: transparent; border-collapse: collapse; border-spacing: 0px;"><p style="margin-bottom: 1.5em; padding: 0px; border: 0px; outline: 0px; font-variant-numeric: normal; font-variant-east-asian: normal; font-stretch: normal; line-height: 19px; font-family: monospace; vertical-align: baseline; background: transparent; letter-spacing: 0.1px; overflow: visible; text-shadow: none;">И.о. Министра</p></td><td style="margin: 0px; padding: 3px 5px; border: 0px; outline: 0px; vertical-align: top; background: transparent; border-collapse: collapse; border-spacing: 0px;"><br></td></tr><tr style="margin: 0px; padding: 0px; border: 0px; outline: 0px; vertical-align: baseline; background: transparent;"><td style="margin: 0px; padding: 3px 5px; border: 0px; outline: 0px; vertical-align: top; background: transparent; border-collapse: collapse; border-spacing: 0px;"><p style="margin-bottom: 1.5em; padding: 0px; border: 0px; outline: 0px; font-variant-numeric: normal; font-variant-east-asian: normal; font-stretch: normal; line-height: 19px; font-family: monospace; vertical-align: baseline; background: transparent; letter-spacing: 0.1px; overflow: visible; text-shadow: none;">национальной экономики</p></td><td style="margin: 0px; padding: 3px 5px; border: 0px; outline: 0px; vertical-align: top; background: transparent; border-collapse: collapse; border-spacing: 0px;"><br></td></tr><tr style="margin: 0px; padding: 0px; border: 0px; outline: 0px; vertical-align: baseline; background: transparent;"><td style="margin: 0px; padding: 3px 5px; border: 0px; outline: 0px; vertical-align: top; background: transparent; border-collapse: collapse; border-spacing: 0px;"><p style="margin-bottom: 1.5em; padding: 0px; border: 0px; outline: 0px; font-variant-numeric: normal; font-variant-east-asian: normal; font-stretch: normal; line-height: 19px; font-family: monospace; vertical-align: baseline; background: transparent; letter-spacing: 0.1px; overflow: visible; text-shadow: none;">Республики Казахстан</p></td><td style="margin: 0px; padding: 3px 5px; border: 0px; outline: 0px; vertical-align: top; background: transparent; border-collapse: collapse; border-spacing: 0px;"><p style="margin-bottom: 1.5em; padding: 0px; border: 0px; outline: 0px; font-variant-numeric: normal; font-variant-east-asian: normal; font-stretch: normal; line-height: 19px; font-family: monospace; vertical-align: baseline; background: transparent; letter-spacing: 0.1px; overflow: visible; text-shadow: none;">М. Кусаинов</p></td></tr></tbody></table><p style="margin-bottom: 1.5em; padding: 0px; border: 0px; outline: 0px; font-variant-numeric: normal; font-variant-east-asian: normal; font-stretch: normal; line-height: 19px; font-family: monospace; vertical-align: baseline; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial; letter-spacing: 0.1px; color: rgb(0, 0, 0); overflow: visible; text-shadow: none;"></p><p style="margin-bottom: 1.5em; padding: 0px; border: 0px; outline: 0px; font-variant-numeric: normal; font-variant-east-asian: normal; font-stretch: normal; line-height: 19px; font-family: monospace; vertical-align: baseline; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial; letter-spacing: 0.1px; color: rgb(0, 0, 0); overflow: visible; text-shadow: none;">      "СОГЛАСОВАН"</p><p style="margin-bottom: 1.5em; padding: 0px; border: 0px; outline: 0px; font-variant-numeric: normal; font-variant-east-asian: normal; font-stretch: normal; line-height: 19px; font-family: monospace; vertical-align: baseline; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial; letter-spacing: 0.1px; color: rgb(0, 0, 0); overflow: visible; text-shadow: none;">      Министр здравоохранения</p><p style="margin-bottom: 1.5em; padding: 0px; border: 0px; outline: 0px; font-variant-numeric: normal; font-variant-east-asian: normal; font-stretch: normal; line-height: 19px; font-family: monospace; vertical-align: baseline; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial; letter-spacing: 0.1px; color: rgb(0, 0, 0); overflow: visible; text-shadow: none;">      и социального развития</p><p style="margin-bottom: 1.5em; padding: 0px; border: 0px; outline: 0px; font-variant-numeric: normal; font-variant-east-asian: normal; font-stretch: normal; line-height: 19px; font-family: monospace; vertical-align: baseline; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial; letter-spacing: 0.1px; color: rgb(0, 0, 0); overflow: visible; text-shadow: none;">      Республики Казахстан</p><p style="margin-bottom: 1.5em; padding: 0px; border: 0px; outline: 0px; font-variant-numeric: normal; font-variant-east-asian: normal; font-stretch: normal; line-height: 19px; font-family: monospace; vertical-align: baseline; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial; letter-spacing: 0.1px; color: rgb(0, 0, 0); overflow: visible; text-shadow: none;">      ____________ Т. Дуйсенова</p><p style="margin-bottom: 1.5em; padding: 0px; border: 0px; outline: 0px; font-variant-numeric: normal; font-variant-east-asian: normal; font-stretch: normal; line-height: 19px; font-family: monospace; vertical-align: baseline; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial; letter-spacing: 0.1px; color: rgb(0, 0, 0); overflow: visible; text-shadow: none;">      5 марта 2015 года</p><p><br style="color: rgb(0, 0, 0); font-family: monospace;"><br style="color: rgb(0, 0, 0); font-family: monospace;"></p><p align="right" style="margin-bottom: 1.5em; padding: 0px; border: 0px; outline: 0px; font-variant-numeric: normal; font-variant-east-asian: normal; font-stretch: normal; line-height: 19px; font-family: monospace; vertical-align: baseline; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial; letter-spacing: 0.1px; color: rgb(0, 0, 0); overflow: visible; text-shadow: none;"></p><table border="0" style="margin: 0px auto; padding: 0px; border: 0px; outline: 0px; vertical-align: baseline; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial; border-spacing: 0px; overflow-wrap: break-word; table-layout: fixed; width: 892px; color: rgb(0, 0, 0); font-family: monospace;"><tbody style="margin: 0px; padding: 0px; border: 0px; outline: 0px; vertical-align: baseline; background: transparent;"><tr style="margin: 0px; padding: 0px; border: 0px; outline: 0px; vertical-align: baseline; background: transparent;"><td align="center" width="387" style="margin: 0px; padding: 3px 5px; border: 0px; outline: 0px; vertical-align: top; background: transparent; border-collapse: collapse; border-spacing: 0px;"> </td><td align="center" width="228" style="margin: 0px; padding: 3px 5px; border: 0px; outline: 0px; vertical-align: top; background: transparent; border-collapse: collapse; border-spacing: 0px;"><a name="z6" style="margin: 0px; padding: 0px; vertical-align: baseline; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial; color: rgb(7, 58, 94);"></a>Утверждены<br>приказом и.о. Министра<br>национальной экономики<br>Республики Казахстан<br>от 24 февраля 2015 года № 128</td></tr></tbody></table><p style="margin-bottom: 1.5em; padding: 0px; border: 0px; outline: 0px; font-variant-numeric: normal; font-variant-east-asian: normal; font-stretch: normal; line-height: 19px; font-family: monospace; vertical-align: baseline; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial; letter-spacing: 0.1px; color: rgb(0, 0, 0); overflow: visible; text-shadow: none;"></p><h3 id="z7" style="margin: 15px 0px 9px; padding: 0px; border: 0px; outline: 0px; font-size: 21px; vertical-align: baseline; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial; font-weight: 400; font-family: monospace; line-height: 26px; text-shadow: rgb(255, 255, 255) 1px 1px; color: rgb(30, 30, 30);">Правила проведения обязательных медицинских осмотров</h3><h3 id="z7" style="margin: 15px 0px 9px; padding: 0px; border: 0px; outline: 0px; vertical-align: baseline; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial; line-height: 26px; text-shadow: rgb(255, 255, 255) 1px 1px;"><font color="#1e1e1e"><span style="font-size: 21px; font-weight: 400;">…</span></font><br></h3><h3 id="z19" style="margin: 15px 0px 9px; padding: 0px; border: 0px; outline: 0px; font-size: 21px; vertical-align: baseline; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial; font-weight: 400; font-family: monospace; line-height: 26px; text-shadow: rgb(255, 255, 255) 1px 1px; color: rgb(30, 30, 30);">Параграф 2. Порядок проведения обязательных периодических<br>медицинских осмотров работающих в контакте с вредными и (или)<br>опасными веществами и производственными факторами</h3><h3 id="z7" style="margin: 15px 0px 9px; line-height: 26px; font-size: 1.40833rem; padding: 0px; border: 0px; outline: 0px; vertical-align: baseline; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial; text-shadow: rgb(255, 255, 255) 1px 1px;"><font color="#1e1e1e"><span style="font-size: 21px; font-weight: 400;">…</span></font><br></h3><p id="z24" style="margin-bottom: 1.5em; padding: 0px; border: 0px; outline: 0px; font-variant-numeric: normal; font-variant-east-asian: normal; font-weight: 400; font-stretch: normal; line-height: 19px; font-family: monospace; vertical-align: baseline; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial; letter-spacing: 0.1px; color: rgb(0, 0, 0); overflow: visible; text-shadow: none;">13. Медицинская организация:</p><p style="margin-bottom: 1.5em; padding: 0px; border: 0px; outline: 0px; font-variant-numeric: normal; font-variant-east-asian: normal; font-weight: 400; font-stretch: normal; line-height: 19px; font-family: monospace; vertical-align: baseline; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial; letter-spacing: 0.1px; color: rgb(0, 0, 0); overflow: visible; text-shadow: none;">      1) создает после получения согласованных с территориальными подразделениями ведомства государственного органа в сфере санитарно-эпидемиологического благополучия населения списков контингентов, подлежащих обязательным периодическим медицинским осмотрам комиссию для проведения обязательных периодических медицинских осмотров и составляет календарный план, в котором определяет вид и объем лабораторных и других исследований с учетом специфики действующих вредных производственных факторов, время и сроки работы врачебной комиссии. При недостатке и отсутствии медицинских работников, проводящих обязательные периодические медицинские осмотры, необходимые исследования проводятся в других медицинских организациях, имеющих лицензию на указанный вид деятельности. План согласовывается с администрацией организации (работодателем);</p><p style="margin-bottom: 1.5em; padding: 0px; border: 0px; outline: 0px; font-variant-numeric: normal; font-variant-east-asian: normal; font-weight: 400; font-stretch: normal; line-height: 19px; font-family: monospace; vertical-align: baseline; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial; letter-spacing: 0.1px; color: rgb(0, 0, 0); overflow: visible; text-shadow: none;">      2) утверждает состав врачебной комиссии. В состав врачебной комиссии входят медицинские работники: терапевт, хирург, невропатолог, отоларинголог, офтальмолог, дерматовенеролог, гинеколог, рентгенолог, врач по функциональной диагностике, врач-лаборант, прошедшие в рамках своей специальности подготовку по профессиональной патологии. Председателем комиссии является врач-профпатолог, имеющий профессиональную переподготовку по профпатологии и сертификат специалиста (профпатолога) и являющийся ответственным лицом за качество проведения обязательных периодических медосмотров. При необходимости к работе врачебной комиссии привлекаются и другие специалисты (стоматолог, кардиолог, аллерголог, эндокринолог, фтизиатр, гематолог), прошедшие в рамках своей специальности подготовку по профессиональной патологии. Медицинские работники, участвующие в обязательных периодических медицинских осмотрах, ознакамливаются с характеристикой профессиональной деятельности и условиями труда работников, представленной работодателем;</p><p style="margin-bottom: 1.5em; padding: 0px; border: 0px; outline: 0px; font-variant-numeric: normal; font-variant-east-asian: normal; font-weight: 400; font-stretch: normal; line-height: 19px; font-family: monospace; vertical-align: baseline; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial; letter-spacing: 0.1px; color: rgb(0, 0, 0); overflow: visible; text-shadow: none;">      3) представляет ежеквартально сводный отчет о проведенном периодическом медицинском осмотре в территориальные подразделения ведомства государственного органа в сфере санитарно-эпидемиологического благополучия населения (в том числе и на транспорте), по форме согласно с <a href="http://adilet.zan.kz/rus/docs/V1500010634#z46" style="margin: 0px; padding: 0px; vertical-align: baseline; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial; color: rgb(7, 58, 94); -webkit-tap-highlight-color: rgb(64, 170, 245);">приложению 1</a> к настоящим Правилам;</p><p style="margin-bottom: 1.5em; padding: 0px; border: 0px; outline: 0px; font-variant-numeric: normal; font-variant-east-asian: normal; font-weight: 400; font-stretch: normal; line-height: 19px; font-family: monospace; vertical-align: baseline; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial; letter-spacing: 0.1px; color: rgb(0, 0, 0); overflow: visible; text-shadow: none;">      4) обобщает результаты по окончанию проведения обязательных периодических медицинских осмотров работников занятых на тяжелых работах, во вредных (особо вредных) и (или) опасных условиях труда и составляет заключительный акт в 5-ти экземплярах по форме согласно с <a href="http://adilet.zan.kz/rus/docs/V1500010634#z48" style="margin: 0px; padding: 0px; vertical-align: baseline; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial; color: rgb(7, 58, 94); -webkit-tap-highlight-color: rgb(64, 170, 245);">приложению 2</a> к настоящим Правилам, предоставляет в территориальные подразделения государственного органа в сфере санитарно-эпидемиологического благополучия населения (в том числе и на транспорте), в течение 30 календарных дней после проведенного обязательного периодического медицинского осмотра. В приложениях к акту дает поименный список лиц, которым рекомендован перевод на другую работу, показано стационарное и санаторно-курортное лечение, диетическое питание, динамическое наблюдение. Заключительные акты после подписания передает для исполнения администрации, профсоюзному комитету организации, в территориальные подразделения ведомства государственного органа в сфере санитарно-эпидемиологического благополучия населения (в том числе и на транспорте) для контроля, в территориальные медицинские организации по месту нахождения работодателя для работы, один экземпляр остается у медицинской организации, проводившей обязательный периодический медицинский осмотр;</p><p style="margin-bottom: 1.5em; padding: 0px; border: 0px; outline: 0px; font-variant-numeric: normal; font-variant-east-asian: normal; font-weight: 400; font-stretch: normal; line-height: 19px; font-family: monospace; vertical-align: baseline; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial; letter-spacing: 0.1px; color: rgb(0, 0, 0); overflow: visible; text-shadow: none;">      5) заносит данные обязательного периодического медицинского осмотра в медицинскую карту амбулаторного пациента по форме 025/у, утвержденной Приказом № 907 и на вкладном листе медицинских осмотров по форме, в соответствии с <a href="http://adilet.zan.kz/rus/docs/V1500010634#z66" style="margin: 0px; padding: 0px; vertical-align: baseline; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial; color: rgb(7, 58, 94); -webkit-tap-highlight-color: rgb(64, 170, 245);">приложению 3</a> к настоящим Правилам, который прикреплен к медицинской карте амбулаторного пациента. При этом каждый медицинский работник, принимающий участие в обязательном периодическом медицинском осмотре, дает свое заключение о профессиональной пригодности. Во вкладном листе медицинской карты амбулаторного пациента выносятся данные профессионального маршрута. При увольнении и переводе в другую организацию медицинская карта амбулаторного пациента с данными обязательных медицинских осмотров передается медицинской организации по месту новой работы. Обязательные периодические медицинские осмотры проводятся при наличии медицинской карты амбулаторного пациента по месту жительства или выписки из нее;</p><p style="margin-bottom: 1.5em; padding: 0px; border: 0px; outline: 0px; font-variant-numeric: normal; font-variant-east-asian: normal; font-weight: 400; font-stretch: normal; line-height: 19px; font-family: monospace; vertical-align: baseline; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial; letter-spacing: 0.1px; color: rgb(0, 0, 0); overflow: visible; text-shadow: none;">      6) оформляет экспертное заключение врачебной комиссии о профессиональной пригодности с учетом медицинской документации с места жительства независимо от вида медицинского осмотра. При этом заключение врачебной комиссии лицам, которым противопоказана работа во вредных и (или) опасных условиях труда, не выдается. Экспертное заключение в течение трех рабочих дней направляется работодателю, с одновременным извещением лица, которому противопоказана работа с вредными производственными факторами.</p><span class="note" style="margin: 0px; padding: 0px; border: 0px; outline: 0px; font-size: 13px; vertical-align: baseline; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial; color: red; font-family: monospace; font-weight: 400;">      Сноска. Пункт 13 с изменением, внесенным приказом Министра национальной экономики РК от 23.11.2016 </span><a href="http://adilet.zan.kz/rus/docs/V1600014707#z20" style="margin: 0px; padding: 0px; font-size: 13px; vertical-align: baseline; background: rgb(255, 255, 255); color: rgb(7, 58, 94); -webkit-tap-highlight-color: rgb(64, 170, 245); font-family: monospace; font-weight: 400;">№ 485</a><span class="note" style="margin: 0px; padding: 0px; border: 0px; outline: 0px; font-size: 13px; vertical-align: baseline; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial; color: red; font-family: monospace; font-weight: 400;"> (вводится в действие по истечении десяти календарных дней после дня его первого официального опубликования).</span><br style="color: rgb(0, 0, 0); font-family: monospace; font-size: 13px; font-weight: 400;"><p id="z25" style="margin-bottom: 1.5em; padding: 0px; border: 0px; outline: 0px; font-variant-numeric: normal; font-variant-east-asian: normal; font-weight: 400; font-stretch: normal; line-height: 19px; font-family: monospace; vertical-align: baseline; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial; letter-spacing: 0.1px; color: rgb(0, 0, 0); overflow: visible; text-shadow: none;">      14. Работодатель:</p><p style="margin-bottom: 1.5em; padding: 0px; border: 0px; outline: 0px; font-variant-numeric: normal; font-variant-east-asian: normal; font-weight: 400; font-stretch: normal; line-height: 19px; font-family: monospace; vertical-align: baseline; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial; letter-spacing: 0.1px; color: rgb(0, 0, 0); overflow: visible; text-shadow: none;">      1) составляет не позднее 1 декабря список лиц подлежащих обязательному медицинскому осмотру по форме, согласно <a href="http://adilet.zan.kz/rus/docs/V1600014707#z68" style="margin: 0px; padding: 0px; vertical-align: baseline; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial; color: rgb(7, 58, 94); -webkit-tap-highlight-color: rgb(64, 170, 245);">приложению 3-1</a> к настоящим Правилам руководствуясь Перечнем вредных производственных факторов, профессий, при которых проводятся обязательные медицинские осмотры, утвержденным приказом Министра национальной экономики Республики Казахстан от 28 февраля 2015 года № 175 (зарегистрированный в Реестре государственной регистрации нормативных правовых актов за № 10987) с последующим согласованием с территориальными подразделениями ведомства государственного органа в сфере санитарно-эпидемиологического благополучия населения (в том числе на транспорте);</p><p style="margin-bottom: 1.5em; padding: 0px; border: 0px; outline: 0px; font-variant-numeric: normal; font-variant-east-asian: normal; font-weight: 400; font-stretch: normal; line-height: 19px; font-family: monospace; vertical-align: baseline; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial; letter-spacing: 0.1px; color: rgb(0, 0, 0); overflow: visible; text-shadow: none;">      2) организует за счет собственных средств проведение периодического медицинского осмотра;</p><p style="margin-bottom: 1.5em; padding: 0px; border: 0px; outline: 0px; font-variant-numeric: normal; font-variant-east-asian: normal; font-weight: 400; font-stretch: normal; line-height: 19px; font-family: monospace; vertical-align: baseline; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial; letter-spacing: 0.1px; color: rgb(0, 0, 0); overflow: visible; text-shadow: none;">      3) обеспечивает совместно с медицинской организацией, обслуживающей предприятие, или с территориальной медицинской организацией по месту нахождения работодателя своевременное направление больных на углубленное обследование и лечение в центры профессиональной патологии лиц с профессиональными заболеваниями и подозрением на них;</p><p style="margin-bottom: 1.5em; padding: 0px; border: 0px; outline: 0px; font-variant-numeric: normal; font-variant-east-asian: normal; font-weight: 400; font-stretch: normal; line-height: 19px; font-family: monospace; vertical-align: baseline; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial; letter-spacing: 0.1px; color: rgb(0, 0, 0); overflow: visible; text-shadow: none;">      4) разрабатывает совместно с медицинской организацией, обслуживающей предприятие, или с территориальной медицинской организацией по месту нахождения работодателя, ежегодный план мероприятий по оздоровлению выявленных больных, согласованный с территориальным подразделением ведомства государственного органа в сфере санитарно-эпидемиологического благополучия населения (в том числе на транспорте) по улучшению условий труда.</p><span class="note" style="margin: 0px; padding: 0px; border: 0px; outline: 0px; font-size: 13px; vertical-align: baseline; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial; color: red; font-family: monospace; font-weight: 400;">      Сноска. Пункт 14 с изменением, внесенным приказом Министра национальной экономики РК от 23.11.2016 </span><a href="http://adilet.zan.kz/rus/docs/V1600014707#z22" style="margin: 0px; padding: 0px; font-size: 13px; vertical-align: baseline; background: rgb(255, 255, 255); color: rgb(7, 58, 94); -webkit-tap-highlight-color: rgb(64, 170, 245); font-family: monospace; font-weight: 400;">№ 485</a><span class="note" style="margin: 0px; padding: 0px; border: 0px; outline: 0px; font-size: 13px; vertical-align: baseline; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial; color: red; font-family: monospace; font-weight: 400;"> (вводится в действие по истечении десяти календарных дней после дня его первого официального опубликования).</span><br style="color: rgb(0, 0, 0); font-family: monospace; font-size: 13px; font-weight: 400;"><p id="z26" style="margin-bottom: 1.5em; padding: 0px; border: 0px; outline: 0px; font-variant-numeric: normal; font-variant-east-asian: normal; font-weight: 400; font-stretch: normal; line-height: 19px; font-family: monospace; vertical-align: baseline; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial; letter-spacing: 0.1px; color: rgb(0, 0, 0); overflow: visible; text-shadow: none;">      15. По результатам обязательного периодического медицинского осмотра медицинской организацией, обслуживающей предприятие, или с территориальной медицинской организацией по месту нахождения работодателя, формируются группы, с последующим определением принадлежности работника к одной из диспансерных групп и оформлением рекомендаций по профилактике профессиональных заболеваний и социально-значимых заболеваний – по дальнейшему наблюдению, лечению и реабилитации:</p><p style="margin-bottom: 1.5em; padding: 0px; border: 0px; outline: 0px; font-variant-numeric: normal; font-variant-east-asian: normal; font-weight: 400; font-stretch: normal; line-height: 19px; font-family: monospace; vertical-align: baseline; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial; letter-spacing: 0.1px; color: rgb(0, 0, 0); overflow: visible; text-shadow: none;">      1) здоровые работники, не нуждающиеся в реабилитации;</p><p style="margin-bottom: 1.5em; padding: 0px; border: 0px; outline: 0px; font-variant-numeric: normal; font-variant-east-asian: normal; font-weight: 400; font-stretch: normal; line-height: 19px; font-family: monospace; vertical-align: baseline; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial; letter-spacing: 0.1px; color: rgb(0, 0, 0); overflow: visible; text-shadow: none;">      2) практически здоровые работники, имеющие нестойкие функциональные изменения различных органов и систем;</p><p style="margin-bottom: 1.5em; padding: 0px; border: 0px; outline: 0px; font-variant-numeric: normal; font-variant-east-asian: normal; font-weight: 400; font-stretch: normal; line-height: 19px; font-family: monospace; vertical-align: baseline; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial; letter-spacing: 0.1px; color: rgb(0, 0, 0); overflow: visible; text-shadow: none;">      3) работники, имеющие начальные формы общих заболеваний;</p><p style="margin-bottom: 1.5em; padding: 0px; border: 0px; outline: 0px; font-variant-numeric: normal; font-variant-east-asian: normal; font-weight: 400; font-stretch: normal; line-height: 19px; font-family: monospace; vertical-align: baseline; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial; letter-spacing: 0.1px; color: rgb(0, 0, 0); overflow: visible; text-shadow: none;">      4) работники, имеющие выраженные формы общих заболеваний, как являющиеся, так и не являющиеся противопоказанием для продолжения работы в профессии;</p><p style="margin-bottom: 1.5em; padding: 0px; border: 0px; outline: 0px; font-variant-numeric: normal; font-variant-east-asian: normal; font-weight: 400; font-stretch: normal; line-height: 19px; font-family: monospace; vertical-align: baseline; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial; letter-spacing: 0.1px; color: rgb(0, 0, 0); overflow: visible; text-shadow: none;">      5) работники, имеющие признаки воздействия на организм вредных производственных факторов;</p><p style="margin-bottom: 1.5em; padding: 0px; border: 0px; outline: 0px; font-variant-numeric: normal; font-variant-east-asian: normal; font-weight: 400; font-stretch: normal; line-height: 19px; font-family: monospace; vertical-align: baseline; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial; letter-spacing: 0.1px; color: rgb(0, 0, 0); overflow: visible; text-shadow: none;">      6) работники, имеющие признаки профессиональных заболеваний.</p>""")

    def write(self, values):
        """ Updating write function to be able to add corresponding lab test when we choose appointment type
        """
        for app in self:
            type_of_appointment = values['type_of_appointment'] if values['type_of_appointment'] else app.type_of_appointment
            lab_test = self.env["lab.test"].search([('type_of_appointment', '=', type_of_appointment)])
            for app_line in app.appointment_lines:
                app_line.test_line_appointment = False
            if lab_test:
                for lab in lab_test:
                    new_lab_test = self.env["lab.appointment.lines"].sudo().create({
                        'lab_test': lab.id,
                        'test_line_appointment': app.id,  # Create link to appointment
                        'cost': lab.test_cost
                    })
        return super(Appointment, self).write(values)

    def action_request(self):
        if self.appointment_lines:
            for line in self.appointment_lines:
                data = self.env['lab.test'].search([('lab_test', '=', line.lab_test.lab_test)])
                lab_request_new = self.env['lab.request'].create({
                    'lab_request_id': self.name,
                    'app_id': self.id,
                    'lab_requestor': self.patient_id.id,
                    'lab_requesting_date': self.appointment_date,
                    'test_request': line.lab_test.id,
                    })
                for dat in data.test_lines:
                    request_line_new = self.env['lab.test.attribute'].create({
                        'interval': dat.interval,
                        'interval_max': dat.interval_max,
                        'test_content': dat.test_content.id,
                        'test_request_reverse': lab_request_new.id,
                        'unit': dat.unit.id
                    })
            self.state = 'request_lab'
        else:
            raise UserError(_('Please Select Lab Test.'))